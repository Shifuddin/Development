                        <p class="Para">This paper describes a new attack on the anonymity of web browsing with Tor. The attack tricks a user’s web browser into sending a distinctive signal over the Tor network that can be detected using traffic analysis. It is delivered by a malicious exit node using a man-in-the-middle attack on HTTP. Both the attack and the traffic analysis can be performed by an adversary with limited resources. While the attack can only succeed if the attacker controls one of the victim’s entry guards, the method reduces the time required for a traffic analysis attack on Tor from <em class="EmphasisTypeItalic ">O</em>(<em class="EmphasisTypeItalic ">nk</em>) to <em class="EmphasisTypeItalic ">O</em>(<em class="EmphasisTypeItalic ">n</em> + <em class="EmphasisTypeItalic ">k</em>), where <em class="EmphasisTypeItalic ">n</em> is the number of exit nodes and <em class="EmphasisTypeItalic ">k</em> is the number of entry guards. This paper presents techniques that exploit the Tor exit policy system to greatly simplify the traffic analysis. The fundamental vulnerability exposed by this paper is not specific to Tor but rather to the problem of anonymous web browsing itself. This paper also describes a related attack on users who toggle the use of Tor with the popular Firefox extension Torbutton.</p>
